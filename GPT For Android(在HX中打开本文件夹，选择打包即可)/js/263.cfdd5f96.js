"use strict";(self["webpackChunkeasygpt"]=self["webpackChunkeasygpt"]||[]).push([[263],{472:function(t,n,e){e.a(t,(async function(t,o){try{e(7658);var l=e(3396),a=e(7139),c=e(4870),s=e(9242),i=e(2325),r=e(2483),u=e(7877),d=e(9733),m=e(5216),f=t([u]);u=(f.then?(await f)():f)[0];const g=t=>((0,l.dD)("data-v-44e99735"),t=t(),(0,l.Cn)(),t),h=g((()=>(0,l._)("span",null,"管理预设",-1))),p=g((()=>(0,l._)("span",null,"配置 GPT",-1))),v={class:"history-scroll"},w={class:"content"},B=["onClick"],y=g((()=>(0,l._)("div",{class:"end"},null,-1)));n.Z={__name:"Home",setup(t){const n=(0,r.tv)(),e=i.ID,o=(0,c.qj)([]),f=(0,c.qj)({});async function g(){if(localStorage.removeItem("history"),localStorage.setting){const t=JSON.parse(localStorage.setting);f.theme=t.theme,f.fontSize=t.fontSize}const t=await(0,u.RC)();if(!t)return(0,d.CF)("获取历史数据失败！");t.forEach((t=>{-1==o.findIndex((n=>n.id==t.id))&&o.push(t)}))}function C(t){(0,m.WD)({message:"你确定要删除该记录吗 ?"}).then((async()=>{const n=o.findIndex((n=>n.id==t)),e=await(0,u.cm)(t);e?(o.splice(n,1),(0,d.CF)("删除成功!")):(0,d.CF)("删除失败!")})).catch((()=>{}))}function b(t){if(0==t.length)return"00:00";const n=t[t.length-1].date,e=Date.now()-n;return e<6e4?"刚刚":e<36e5?"1小时内":e<864e5?(0,i.p6)(n,"DD日hh:mm"):e<2592e6?(0,i.p6)(n,"MM/DD hh:mm"):(0,i.p6)(n,"YYYY/MM/DD hh:mm")}function k(t){localStorage.history=JSON.stringify({...t}),n.push("/")}return(0,l.ic)((async()=>{await g()})),(0,l.bv)((async()=>{await g()})),(t,i)=>{const r=(0,l.up)("van-nav-bar"),u=(0,l.up)("van-empty"),d=(0,l.up)("van-button");return(0,l.wg)(),(0,l.iD)("div",{class:(0,a.C_)(["container",f.theme?"bright":"dark"]),style:(0,a.j5)("font-size:"+f.fontSize+"em")},[(0,l.Wm)(r,{title:"会话记录",onClickRight:i[0]||(i[0]=t=>(0,c.SU)(n).push("/setting")),onClickLeft:i[1]||(i[1]=t=>(0,c.SU)(n).push("/preinstall"))},{left:(0,l.w5)((()=>[h])),right:(0,l.w5)((()=>[p])),_:1}),(0,l._)("div",v,[(0,l._)("div",w,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(o,(t=>(0,l.wy)(((0,l.wg)(),(0,l.iD)("div",{class:"item",key:t.id,onClick:n=>k(t)},[(0,l._)("div",null,[(0,l._)("h2",null,(0,a.zw)(t.role.name),1)]),(0,l._)("div",null,[(0,l._)("span",null,(0,a.zw)(t.dialog.length)+" 条对话",1),(0,l._)("span",null,(0,a.zw)(b(t.dialog)),1)])],8,B)),[[(0,c.SU)(e),()=>C(t.id),void 0,{"stop-circle":!0}]]))),128)),(0,l.wy)((0,l.Wm)(u,{description:"会话记录为空"},null,512),[[s.F8,0==o.length]]),y])]),(0,l.Wm)(d,{icon:"plus",type:"primary",text:"创建对话",onClick:i[2]||(i[2]=t=>(0,c.SU)(n).push("/create-session"))})],6)}}},o()}catch(g){o(g)}}))},4263:function(t,n,e){e.a(t,(async function(t,o){try{e.r(n);var l=e(719),a=(e(655),e(89)),c=t([l]);l=(c.then?(await c)():c)[0];const s=(0,a.Z)(l.Z,[["__scopeId","data-v-44e99735"]]);n["default"]=s,o()}catch(s){o(s)}}))},655:function(){},719:function(t,n,e){e.a(t,(async function(t,o){try{e.d(n,{Z:function(){return l.Z}});var l=e(472),a=t([l]);l=(a.then?(await a)():a)[0],o()}catch(c){o(c)}}))},5216:function(t,n,e){e.d(n,{WD:function(){return E},vC:function(){return Y}});var o=e(3396),l=e(2220),a=e(7548),c=e(4870),s=e(9242),i=e(610),r=e(5323),u=e(9951),d=e(6491),m=e(5322),f=e(6048),g=e(4877),h=e(6305),p=e(9545),v=e(1404),w=e(253),B=e(4373);const[y,C]=(0,i["do"])("action-bar"),b=Symbol(y),k={placeholder:Boolean,safeAreaInsetBottom:r.J5};var S=(0,o.aZ)({name:y,props:k,setup(t,{slots:n}){const e=(0,c.iH)(),l=(0,B.J)(e,C),{linkChildren:a}=(0,w.$E)(b);a();const s=()=>{var l;return(0,o.Wm)("div",{ref:e,class:[C(),{"van-safe-area-bottom":t.safeAreaInsetBottom}]},[null==(l=n.default)?void 0:l.call(n)])};return()=>t.placeholder?l(s):s()}});const D=(0,v.n)(S);var x=e(3444),W=e(6014);const[_,z]=(0,i["do"])("action-bar-button"),T=(0,l.l7)({},W.g2,{type:String,text:String,icon:String,color:String,loading:Boolean,disabled:Boolean});var H=(0,o.aZ)({name:_,props:T,setup(t,{slots:n}){const e=(0,W.yj)(),{parent:l,index:a}=(0,w.NB)(b),c=(0,o.Fl)((()=>{if(l){const t=l.children[a.value-1];return!(t&&"isButton"in t)}})),s=(0,o.Fl)((()=>{if(l){const t=l.children[a.value+1];return!(t&&"isButton"in t)}}));return(0,x.F)({isButton:!0}),()=>{const{type:l,icon:a,text:i,color:r,loading:u,disabled:d}=t;return(0,o.Wm)(p.zx,{class:z([l,{last:s.value,first:c.value}]),size:"large",type:l,icon:a,color:r,loading:u,disabled:d,onClick:e},{default:()=>[n.default?n.default():i]})}}});const O=(0,v.n)(H);const[Z,F,I]=(0,i["do"])("dialog"),N=(0,l.l7)({},g.W,{title:String,theme:String,width:r.Or,message:[String,Function],callback:Function,allowHtml:Boolean,className:r.Vg,transition:(0,r.SQ)("van-dialog-bounce"),messageAlign:String,closeOnPopstate:r.J5,showCancelButton:Boolean,cancelButtonText:String,cancelButtonColor:String,cancelButtonDisabled:Boolean,confirmButtonText:String,confirmButtonColor:String,confirmButtonDisabled:Boolean,showConfirmButton:r.J5,closeOnClickOverlay:Boolean}),J=[...g.m,"transition","closeOnPopstate"];var P=(0,o.aZ)({name:Z,props:N,emits:["confirm","cancel","keydown","update:show"],setup(t,{emit:n,slots:e}){const a=(0,c.iH)(),i=(0,c.qj)({confirm:!1,cancel:!1}),r=t=>n("update:show",t),g=n=>{var e;r(!1),null==(e=t.callback)||e.call(t,n)},v=e=>()=>{t.show&&(n(e),t.beforeClose?(i[e]=!0,(0,u.I)(t.beforeClose,{args:[e],done(){g(e),i[e]=!1},canceled(){i[e]=!1}})):g(e))},w=v("cancel"),B=v("confirm"),y=(0,s.D2)((e=>{var o,c;if(e.target!==(null==(c=null==(o=a.value)?void 0:o.popupRef)?void 0:c.value))return;const s={Enter:t.showConfirmButton?B:l.ZT,Escape:t.showCancelButton?w:l.ZT};s[e.key](),n("keydown",e)}),["enter","esc"]),C=()=>{const n=e.title?e.title():t.title;if(n)return(0,o.Wm)("div",{class:F("header",{isolated:!t.message&&!e.default})},[n])},b=n=>{const{message:e,allowHtml:l,messageAlign:a}=t,c=F("message",{"has-title":n,[a]:a}),s=(0,d.mf)(e)?e():e;return l&&"string"===typeof s?(0,o.Wm)("div",{class:c,innerHTML:s},null):(0,o.Wm)("div",{class:c},[s])},k=()=>{if(e.default)return(0,o.Wm)("div",{class:F("content")},[e.default()]);const{title:n,message:l,allowHtml:a}=t;if(l){const t=!(!n&&!e.title);return(0,o.Wm)("div",{key:a?1:0,class:F("content",{isolated:!t})},[b(t)])}},S=()=>(0,o.Wm)("div",{class:[m.k7,F("footer")]},[t.showCancelButton&&(0,o.Wm)(p.zx,{size:"large",text:t.cancelButtonText||I("cancel"),class:F("cancel"),style:{color:t.cancelButtonColor},loading:i.cancel,disabled:t.cancelButtonDisabled,onClick:w},null),t.showConfirmButton&&(0,o.Wm)(p.zx,{size:"large",text:t.confirmButtonText||I("confirm"),class:[F("confirm"),{[m.a8]:t.showCancelButton}],style:{color:t.confirmButtonColor},loading:i.confirm,disabled:t.confirmButtonDisabled,onClick:B},null)]),x=()=>(0,o.Wm)(D,{class:F("footer")},{default:()=>[t.showCancelButton&&(0,o.Wm)(O,{type:"warning",text:t.cancelButtonText||I("cancel"),class:F("cancel"),color:t.cancelButtonColor,loading:i.cancel,disabled:t.cancelButtonDisabled,onClick:w},null),t.showConfirmButton&&(0,o.Wm)(O,{type:"danger",text:t.confirmButtonText||I("confirm"),class:F("confirm"),color:t.confirmButtonColor,loading:i.confirm,disabled:t.confirmButtonDisabled,onClick:B},null)]}),W=()=>e.footer?e.footer():"round-button"===t.theme?x():S();return()=>{const{width:n,title:e,theme:c,message:s,className:i}=t;return(0,o.Wm)(h.GI,(0,o.dG)({ref:a,role:"dialog",class:[F([c]),i],style:{width:(0,f.Nn)(n)},tabindex:0,"aria-labelledby":e||s,onKeydown:y,"onUpdate:show":r},(0,l.ei)(t,J)),{default:()=>[C(),k(),W()]})}}});let U;const j={title:"",width:"",theme:null,message:"",overlay:!0,callback:null,teleport:"body",className:"",allowHtml:!1,lockScroll:!0,transition:void 0,beforeClose:null,overlayClass:"",overlayStyle:void 0,messageAlign:"",cancelButtonText:"",cancelButtonColor:null,cancelButtonDisabled:!1,confirmButtonText:"",confirmButtonColor:null,confirmButtonDisabled:!1,showConfirmButton:!0,showCancelButton:!1,closeOnPopstate:!0,closeOnClickOverlay:!1};let A=(0,l.l7)({},j);function M(){const t={setup(){const{state:t,toggle:n}=(0,a.o)();return()=>(0,o.Wm)(P,(0,o.dG)(t,{"onUpdate:show":n}),null)}};({instance:U}=(0,a.H)(t))}function Y(t){return l._f?new Promise(((n,e)=>{U||M(),U.open((0,l.l7)({},A,t,{callback:t=>{("confirm"===t?n:e)(t)}}))})):Promise.resolve()}const E=t=>Y((0,l.l7)({showCancelButton:!0},t))}}]);
//# sourceMappingURL=263.cfdd5f96.js.map