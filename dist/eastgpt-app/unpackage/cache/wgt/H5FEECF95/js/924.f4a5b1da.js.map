{"version":3,"file":"js/924.f4a5b1da.js","mappings":"wgBAiCA,MAAMA,GAASC,EAAAA,EAAAA,MAETC,GAAUC,EAAAA,EAAAA,IAAS,IAEnBC,GAAUD,EAAAA,EAAAA,IAAS,CAAC,GAsB1BE,eAAeC,EAAcC,EAAM,CAAEC,KAAM,UAAWC,OAAQ,KAE5D,MAAMC,EAAU,CAAEC,GAAIC,KAAKC,MAAOC,KAAM,IAAKP,GAAOE,OAAQ,IAEtDM,QAAeC,EAAAA,EAAAA,IAAkBN,GAEvC,GAAIK,EAEF,OADAE,aAAaP,QAAUQ,KAAKC,UAAUT,GAC/BV,EAAOoB,QAAQ,MAGxBC,EAAAA,EAAAA,IAAU,uBACZ,C,OAhCAC,EAAAA,EAAAA,IAAMpB,GAAUqB,IACdN,aAAaf,QAAUgB,KAAKC,UAAUI,EAAG,KAG3CC,EAAAA,EAAAA,KAAU,KAER,GAAIP,aAAab,QAAS,CACxB,MAAMW,EAASG,KAAKO,MAAMR,aAAab,SACvCA,EAAQsB,MAAQX,EAAOW,MACvBtB,EAAQuB,SAAWZ,EAAOY,QAC5B,CAEA,GAAKV,aAAaf,QAElB,IACE,MAAM0B,EAAKV,KAAKO,MAAMR,aAAaf,SACnCA,EAAQ2B,QAAQD,EAClB,CAAE,MAAOE,GAASC,QAAQD,MAAMA,EAAO,K,q1BClDzC,MAAME,GAA2B,OAAgB,IAAQ,CAAC,CAAC,YAAY,qBAEvE,e","sources":["webpack://easygpt/./src/pages/CreateSession.vue","webpack://easygpt/./src/pages/CreateSession.vue?3d26"],"sourcesContent":["<template>\r\n  <div class=\"container\" :class=\"setting.theme ? 'bright' : 'dark'\" :style=\"'font-size:' + setting.fontSize + 'em'\">\r\n    <!-- 头部导航 -->\r\n    <van-nav-bar title=\"请选择一个预设\" @click-left=\"router.back()\" left-arrow />\r\n    <!-- 会话记录滚动区 -->\r\n    <div class=\"history-scroll\">\r\n      <div class=\"content\">\r\n        <div class=\"item\" @click=\"createSession()\">\r\n          <div>\r\n            <h2>默认聊天机器人</h2>\r\n          </div>\r\n          <van-text-ellipsis rows=\"3\" content=\"该预设有任何提示词！\" />\r\n        </div>\r\n        <!-- 历史记录列表 -->\r\n        <div class=\"item\" v-for=\"item in preList\" :key=\"item.id\" @click=\"createSession(item)\">\r\n          <div>\r\n            <h2>{{ item.name }}</h2>\r\n          </div>\r\n          <van-text-ellipsis rows=\"3\" :content=\"item.dialog\" />\r\n        </div>\r\n        <!-- 占位 50 px -->\r\n        <div class=\"end\"></div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { onMounted, reactive, watch } from 'vue'\r\nimport { useRouter } from 'vue-router'\r\nimport { httpCreateSession } from '@/api'\r\nimport { showToast } from 'vant'\r\n\r\nconst router = useRouter()\r\n\r\nconst preList = reactive([])\r\n\r\nconst setting = reactive({})\r\n\r\nwatch(preList, (nv) => {\r\n  localStorage.preList = JSON.stringify(nv)\r\n})\r\n\r\nonMounted(() => {\r\n  // 初始化设置项\r\n  if (localStorage.setting) {\r\n    const result = JSON.parse(localStorage.setting)\r\n    setting.theme = result.theme\r\n    setting.fontSize = result.fontSize\r\n  }\r\n\r\n  if (!localStorage.preList) return\r\n\r\n  try {\r\n    const pl = JSON.parse(localStorage.preList)\r\n    preList.push(...pl)\r\n  } catch (error) { console.error(error) }\r\n})\r\n\r\nasync function createSession(pre = { name: '默认聊天机器人', dialog: '' }) {\r\n  // 创建一条历史记录\r\n  const history = { id: Date.now(), role: { ...pre }, dialog: [] }\r\n  // 将历史记录添加到数据库\r\n  const result = await httpCreateSession(history)\r\n  // 进入聊天界面\r\n  if (result) {\r\n    localStorage.history = JSON.stringify(history)\r\n    return router.replace('/')\r\n  }\r\n  // 出现错误\r\n  showToast('创建失败，请手动清除应用数据后再次尝试！')\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n@import '@/assets/style/global.scss';\r\n\r\n// 黑夜\r\n.dark {\r\n  background-color: $backgroundColorD;\r\n  color: $colorMinorD;\r\n\r\n  ::v-deep [class*=van-hairline]::after {\r\n    border-color: $backgroundColorStressD;\r\n  }\r\n\r\n  .van-nav-bar {\r\n    ::v-deep * {\r\n      color: $colorMinor;\r\n    }\r\n\r\n    span {\r\n      color: $mainColorD;\r\n    }\r\n\r\n    ::v-deep .van-nav-bar__content {\r\n      background-color: $backgroundColorD;\r\n    }\r\n\r\n    .message-count {\r\n      color: $colorMinorD;\r\n      background-color: $backgroundColorD;\r\n    }\r\n  }\r\n\r\n  .edit-box {\r\n    .van-field {\r\n      background-color: $backgroundColorD;\r\n    }\r\n  }\r\n\r\n  .van-nav-bar {\r\n    span {\r\n      color: $mainColorD;\r\n      border: 1px solid $backgroundColorD;\r\n    }\r\n  }\r\n\r\n  .history-scroll {\r\n    .content {\r\n      .item {\r\n        background-color: $backgroundColorStressD;\r\n\r\n        &>div {\r\n          &:nth-child(2) {\r\n            color: $colorMinorD;\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\n// 白天\r\n.bright {\r\n  background-color: $backgroundColor;\r\n\r\n  .edit-box {\r\n    .van-field {\r\n      background-color: $backgroundColor;\r\n    }\r\n  }\r\n\r\n  .van-nav-bar {\r\n    span {\r\n      color: $mainColor;\r\n      border: 1px solid $backgroundColor;\r\n    }\r\n  }\r\n\r\n  .history-scroll {\r\n    .content {\r\n      .item {\r\n        background-color: $backgroundColorStress;\r\n\r\n        &>div {\r\n          &:nth-child(2) {\r\n            color: $colorMinor;\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\n// 常规\r\n\r\n.container {\r\n  height: 100vh;\r\n  box-sizing: border-box;\r\n  // background-color: $backgroundColor;\r\n  padding-top: 46px;\r\n\r\n  .edit-box {\r\n    padding: 10px;\r\n\r\n    .van-field {\r\n      // background-color: $backgroundColor;\r\n      margin-bottom: 10px;\r\n      border-radius: 5px;\r\n    }\r\n\r\n    .van-button {\r\n      position: absolute;\r\n      width: calc(100% - 20px);\r\n      bottom: 20px;\r\n      border-radius: 5px;\r\n    }\r\n  }\r\n\r\n  .van-nav-bar {\r\n    position: fixed;\r\n    width: 100%;\r\n    top: 0;\r\n\r\n    span {\r\n      font-weight: bold;\r\n      // color: $mainColor;\r\n      // border: 1px solid $backgroundColor;\r\n      padding: 2px 10px;\r\n      border-radius: 5px;\r\n    }\r\n  }\r\n\r\n  &>.van-button {\r\n    position: fixed;\r\n    right: 20px;\r\n    bottom: 30px;\r\n    border-radius: 10px;\r\n  }\r\n\r\n  .history-scroll {\r\n    height: calc(100vh - 46px);\r\n    overflow-y: scroll;\r\n\r\n    .content {\r\n      .end {\r\n        height: 100px;\r\n      }\r\n\r\n      .item {\r\n        margin: 10px 12px;\r\n        padding: 12px;\r\n        border-radius: 6px;\r\n        // background-color: $backgroundColorStress;\r\n\r\n        &>div {\r\n          display: flex;\r\n          justify-content: space-between;\r\n\r\n          &:nth-child(1) {\r\n            margin-bottom: 18px;\r\n\r\n            h2 {\r\n              font-weight: bold;\r\n            }\r\n\r\n            .van-button {\r\n              margin-top: -7px;\r\n            }\r\n          }\r\n\r\n          // &:nth-child(2) {\r\n          //   color: $colorMinor;\r\n          // }\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n</style>","import script from \"./CreateSession.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./CreateSession.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./CreateSession.vue?vue&type=style&index=0&id=2d94cf09&lang=scss&scoped=true\"\n\nimport exportComponent from \"C:\\\\Users\\\\nihao\\\\Desktop\\\\easygpt\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-2d94cf09\"]])\n\nexport default __exports__"],"names":["router","useRouter","preList","reactive","setting","async","createSession","pre","name","dialog","history","id","Date","now","role","result","httpCreateSession","localStorage","JSON","stringify","replace","showToast","watch","nv","onMounted","parse","theme","fontSize","pl","push","error","console","__exports__"],"sourceRoot":""}