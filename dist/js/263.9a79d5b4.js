"use strict";(self["webpackChunkeasygpt"]=self["webpackChunkeasygpt"]||[]).push([[263],{472:function(t,n,e){e.a(t,(async function(t,o){try{e(7658);var l=e(3396),a=e(7139),s=e(4870),c=e(2325),i=e(2483),r=e(7877),u=e(9733),d=e(5216),m=t([r]);r=(m.then?(await m)():m)[0];const f=t=>((0,l.dD)("data-v-7636d65e"),t=t(),(0,l.Cn)(),t),g=f((()=>(0,l._)("span",null,"管理预设",-1))),h=f((()=>(0,l._)("span",null,"配置 GPT",-1))),p={class:"history-scroll"},v={class:"content"},B=["onClick"],w=f((()=>(0,l._)("div",{class:"end"},null,-1)));n.Z={__name:"Home",setup(t){const n=(0,i.tv)(),e=c.I,o=(0,s.qj)([]),m=(0,s.qj)({});function f(t){(0,d.WD)({message:"你确定要删除该记录吗 ?"}).then((async()=>{const n=o.findIndex((n=>n.id==t)),e=await(0,r.cm)(t);e?(o.splice(n,1),(0,u.CF)("删除失败!")):(0,u.CF)("删除失败!")})).catch((()=>{}))}function C(t){if(0==t.length)return"00:00";const n=t[t.length-1].date,e=Date.now()-n;return e<6e4?"刚刚":e<36e5?"1小时内":e<864e5?(0,c.p)(n,"DD日hh:mm"):e<2592e6?(0,c.p)(n,"MM/DD hh:mm"):(0,c.p)(n,"YYYY/MM/DD hh:mm")}function y(t){localStorage.history=JSON.stringify({...t}),n.push("/")}return(0,l.bv)((async()=>{if(localStorage.removeItem("history"),localStorage.setting){const t=JSON.parse(localStorage.setting);m.theme=t.theme,m.fontSize=t.fontSize}const t=await(0,r.RC)();if(!t)return(0,u.CF)("获取历史数据失败！");t.forEach((t=>o.push(t)))})),(t,c)=>{const i=(0,l.up)("van-nav-bar"),r=(0,l.up)("van-empty"),u=(0,l.up)("van-button");return(0,l.wg)(),(0,l.iD)("div",{class:(0,a.C_)(["container",m.theme?"bright":"dark"]),style:(0,a.j5)("font-size:"+m.fontSize+"em")},[(0,l.Wm)(i,{title:"会话记录",onClickRight:c[0]||(c[0]=t=>(0,s.SU)(n).push("/setting")),onClickLeft:c[1]||(c[1]=t=>(0,s.SU)(n).push("/preinstall"))},{left:(0,l.w5)((()=>[g])),right:(0,l.w5)((()=>[h])),_:1}),(0,l._)("div",p,[(0,l._)("div",v,[0==o.length?((0,l.wg)(),(0,l.j4)(r,{key:0,description:"会话记录为空"})):(0,l.kq)("",!0),((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(o,(t=>(0,l.wy)(((0,l.wg)(),(0,l.iD)("div",{class:"item",key:t.id,onClick:n=>y(t)},[(0,l._)("div",null,[(0,l._)("h2",null,(0,a.zw)(t.role.name),1)]),(0,l._)("div",null,[(0,l._)("span",null,(0,a.zw)(t.dialog.length)+" 条对话",1),(0,l._)("span",null,(0,a.zw)(C(t.dialog)),1)])],8,B)),[[(0,s.SU)(e),()=>f(t.id)]]))),128)),w])]),(0,l.Wm)(u,{icon:"plus",type:"primary",text:"创建对话",onClick:c[2]||(c[2]=t=>(0,s.SU)(n).push("/create-session"))})],6)}}},o()}catch(f){o(f)}}))},4263:function(t,n,e){e.a(t,(async function(t,o){try{e.r(n);var l=e(719),a=(e(7354),e(89)),s=t([l]);l=(s.then?(await s)():s)[0];const c=(0,a.Z)(l.Z,[["__scopeId","data-v-7636d65e"]]);n["default"]=c,o()}catch(c){o(c)}}))},7354:function(){},719:function(t,n,e){e.a(t,(async function(t,o){try{e.d(n,{Z:function(){return l.Z}});var l=e(472),a=t([l]);l=(a.then?(await a)():a)[0],o()}catch(s){o(s)}}))},5216:function(t,n,e){e.d(n,{WD:function(){return q},vC:function(){return Y}});var o=e(3396),l=e(2220),a=e(7548),s=e(4870),c=e(9242),i=e(610),r=e(5323),u=e(9951),d=e(6491),m=e(5322),f=e(6048),g=e(4877),h=e(6305),p=e(9545),v=e(1404),B=e(253),w=e(4373);const[C,y]=(0,i["do"])("action-bar"),b=Symbol(C),k={placeholder:Boolean,safeAreaInsetBottom:r.J5};var S=(0,o.aZ)({name:C,props:k,setup(t,{slots:n}){const e=(0,s.iH)(),l=(0,w.J)(e,y),{linkChildren:a}=(0,B.$E)(b);a();const c=()=>{var l;return(0,o.Wm)("div",{ref:e,class:[y(),{"van-safe-area-bottom":t.safeAreaInsetBottom}]},[null==(l=n.default)?void 0:l.call(n)])};return()=>t.placeholder?l(c):c()}});const D=(0,v.n)(S);var x=e(3444),W=e(6014);const[_,z]=(0,i["do"])("action-bar-button"),T=(0,l.l7)({},W.g2,{type:String,text:String,icon:String,color:String,loading:Boolean,disabled:Boolean});var H=(0,o.aZ)({name:_,props:T,setup(t,{slots:n}){const e=(0,W.yj)(),{parent:l,index:a}=(0,B.NB)(b),s=(0,o.Fl)((()=>{if(l){const t=l.children[a.value-1];return!(t&&"isButton"in t)}})),c=(0,o.Fl)((()=>{if(l){const t=l.children[a.value+1];return!(t&&"isButton"in t)}}));return(0,x.F)({isButton:!0}),()=>{const{type:l,icon:a,text:i,color:r,loading:u,disabled:d}=t;return(0,o.Wm)(p.zx,{class:z([l,{last:c.value,first:s.value}]),size:"large",type:l,icon:a,color:r,loading:u,disabled:d,onClick:e},{default:()=>[n.default?n.default():i]})}}});const O=(0,v.n)(H);const[Z,F,I]=(0,i["do"])("dialog"),N=(0,l.l7)({},g.W,{title:String,theme:String,width:r.Or,message:[String,Function],callback:Function,allowHtml:Boolean,className:r.Vg,transition:(0,r.SQ)("van-dialog-bounce"),messageAlign:String,closeOnPopstate:r.J5,showCancelButton:Boolean,cancelButtonText:String,cancelButtonColor:String,cancelButtonDisabled:Boolean,confirmButtonText:String,confirmButtonColor:String,confirmButtonDisabled:Boolean,showConfirmButton:r.J5,closeOnClickOverlay:Boolean}),j=[...g.m,"transition","closeOnPopstate"];var J=(0,o.aZ)({name:Z,props:N,emits:["confirm","cancel","keydown","update:show"],setup(t,{emit:n,slots:e}){const a=(0,s.iH)(),i=(0,s.qj)({confirm:!1,cancel:!1}),r=t=>n("update:show",t),g=n=>{var e;r(!1),null==(e=t.callback)||e.call(t,n)},v=e=>()=>{t.show&&(n(e),t.beforeClose?(i[e]=!0,(0,u.I)(t.beforeClose,{args:[e],done(){g(e),i[e]=!1},canceled(){i[e]=!1}})):g(e))},B=v("cancel"),w=v("confirm"),C=(0,c.D2)((e=>{var o,s;if(e.target!==(null==(s=null==(o=a.value)?void 0:o.popupRef)?void 0:s.value))return;const c={Enter:t.showConfirmButton?w:l.ZT,Escape:t.showCancelButton?B:l.ZT};c[e.key](),n("keydown",e)}),["enter","esc"]),y=()=>{const n=e.title?e.title():t.title;if(n)return(0,o.Wm)("div",{class:F("header",{isolated:!t.message&&!e.default})},[n])},b=n=>{const{message:e,allowHtml:l,messageAlign:a}=t,s=F("message",{"has-title":n,[a]:a}),c=(0,d.mf)(e)?e():e;return l&&"string"===typeof c?(0,o.Wm)("div",{class:s,innerHTML:c},null):(0,o.Wm)("div",{class:s},[c])},k=()=>{if(e.default)return(0,o.Wm)("div",{class:F("content")},[e.default()]);const{title:n,message:l,allowHtml:a}=t;if(l){const t=!(!n&&!e.title);return(0,o.Wm)("div",{key:a?1:0,class:F("content",{isolated:!t})},[b(t)])}},S=()=>(0,o.Wm)("div",{class:[m.k7,F("footer")]},[t.showCancelButton&&(0,o.Wm)(p.zx,{size:"large",text:t.cancelButtonText||I("cancel"),class:F("cancel"),style:{color:t.cancelButtonColor},loading:i.cancel,disabled:t.cancelButtonDisabled,onClick:B},null),t.showConfirmButton&&(0,o.Wm)(p.zx,{size:"large",text:t.confirmButtonText||I("confirm"),class:[F("confirm"),{[m.a8]:t.showCancelButton}],style:{color:t.confirmButtonColor},loading:i.confirm,disabled:t.confirmButtonDisabled,onClick:w},null)]),x=()=>(0,o.Wm)(D,{class:F("footer")},{default:()=>[t.showCancelButton&&(0,o.Wm)(O,{type:"warning",text:t.cancelButtonText||I("cancel"),class:F("cancel"),color:t.cancelButtonColor,loading:i.cancel,disabled:t.cancelButtonDisabled,onClick:B},null),t.showConfirmButton&&(0,o.Wm)(O,{type:"danger",text:t.confirmButtonText||I("confirm"),class:F("confirm"),color:t.confirmButtonColor,loading:i.confirm,disabled:t.confirmButtonDisabled,onClick:w},null)]}),W=()=>e.footer?e.footer():"round-button"===t.theme?x():S();return()=>{const{width:n,title:e,theme:s,message:c,className:i}=t;return(0,o.Wm)(h.GI,(0,o.dG)({ref:a,role:"dialog",class:[F([s]),i],style:{width:(0,f.Nn)(n)},tabindex:0,"aria-labelledby":e||c,onKeydown:C,"onUpdate:show":r},(0,l.ei)(t,j)),{default:()=>[y(),k(),W()]})}}});let P;const U={title:"",width:"",theme:null,message:"",overlay:!0,callback:null,teleport:"body",className:"",allowHtml:!1,lockScroll:!0,transition:void 0,beforeClose:null,overlayClass:"",overlayStyle:void 0,messageAlign:"",cancelButtonText:"",cancelButtonColor:null,cancelButtonDisabled:!1,confirmButtonText:"",confirmButtonColor:null,confirmButtonDisabled:!1,showConfirmButton:!0,showCancelButton:!1,closeOnPopstate:!0,closeOnClickOverlay:!1};let A=(0,l.l7)({},U);function M(){const t={setup(){const{state:t,toggle:n}=(0,a.o)();return()=>(0,o.Wm)(J,(0,o.dG)(t,{"onUpdate:show":n}),null)}};({instance:P}=(0,a.H)(t))}function Y(t){return l._f?new Promise(((n,e)=>{P||M(),P.open((0,l.l7)({},A,t,{callback:t=>{("confirm"===t?n:e)(t)}}))})):Promise.resolve()}const q=t=>Y((0,l.l7)({showCancelButton:!0},t))}}]);
//# sourceMappingURL=263.9a79d5b4.js.map